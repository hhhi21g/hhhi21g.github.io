---

layout: post

title: 02_Augmenting Sequential Recommendation with Balanced Relevance and Diversity

date: 2025-03-02 14:34:23 +0900

categories: [Recommendation]
---

### Augmenting Sequential Recommendation with Balanced Relevance and Diversity

æ¥æºï¼š AAAIâ€˜25  &nbsp;https://doi.org/10.48550/arXiv.2412.08300

ä»£ç ï¼šhttps://github.com/KingGugu/BASRec.

#### é—®é¢˜çš„å¼•å‡º

- å¢å¼ºæ•°æ®çš„ç›¸å…³æ€§å’Œå¤šæ ·æ€§ä¹‹é—´çš„ä¸å¹³è¡¡ä»éœ€è¦è§£å†³ï¼›

- ç›´æ¥åˆå¹¶ä¸¤ä¸ªå¢å¼ºåºåˆ—å°†ä¼šç ´ååŸå§‹åºåˆ—æ¨¡å¼ï¼Œå¹¶ä¸”ä¸ç›¸å…³æˆ–é‡å¤çš„é¡¹å°†ä¼šè¢«ä¿å­˜ï¼›

- ç°æœ‰çš„æ–¹æ³•ç¼ºå°‘å¯¹è·¨åºåˆ—åå¥½æ¨¡å¼å’Œè¯­ä¹‰ä¿¡æ¯çš„æ³¨é‡ï¼›

  > lack consideration for the cross-sequence preference patterns and semantic information.

æå‡º**BASRec**, **B**alanced data **A**ugmentation plugin for **S**equential **Rec**ommendation

------

#### å‡†å¤‡å·¥ä½œ

##### é—®é¢˜ç¬¦å·åŒ–

user sets: **ğ’°**

item sets: **ğ’±**

Each user uâˆˆ**ğ’°** is associated with *a sequence of interacted items* in chronological(æŒ‰æ—¶é—´å‰åé¡ºåºæ’åˆ—çš„) order s<sub>u</sub> = [v<sub>1</sub>,...,v<sub>j</sub>,...v<sub>\|s<sub>u</sub>\|</sub>]

- v<sub>j</sub> : user u ä¸è¯¥ç‰©ä½“äº¤äº’åœ¨æ—¶é—´æ­¥é•¿ä¸ºjæ—¶
- \|s<sub>u</sub>\| : åºåˆ—é•¿åº¦

ç»™å‡ºäº¤äº’ç‰©ä½“åºåˆ—\|s<sub>u</sub>\|, ä»»åŠ¡æ˜¯æ­£ç¡®çš„é¢„æµ‹: ç”¨æˆ·uåœ¨æ—¶é—´æ­¥é•¿ä¸º\|s<sub>u</sub>\|+1æ—¶æœ€å¯èƒ½äº¤äº’çš„ç‰©ä½“v<sup>*</sup>

<p align="center">
    <img src="https://hhhi21g.github.io/public/img/a1.png" alt="alt text" style="zoom:50%;" />
</p>

##### ç”¨äºæ•°æ®å¢å¼ºçš„æ··åˆ(Mixup for Data Augmentation)

åœ¨è¾“å…¥ç©ºé—´ä¸­å®ç°çº¿æ€§æ’å€¼æ¥æ„å»ºè™šæ‹Ÿè®­ç»ƒæ•°æ®

> It implements linear interpolation in the input space to construct virtual training data.

ç»™å‡ºä¸¤ä¸ªè¾“å…¥æ ·æœ¬x<sub>i</sub>ï¼Œx<sub>j</sub>ï¼Œä»¥åŠæ ‡ç­¾y<sub>i</sub>ï¼Œy<sub>j</sub>ï¼Œæ··åˆè¿‡ç¨‹å¦‚ä¸‹ï¼š

<p align="center">
    <img src="https://hhhi21g.github.io/public/img/ar02/a0.png" alt="alt text" style="zoom:67%;" />
</p>

*Î»* *âˆ¼* Beta(*Î±, Î±*)ä¸º**betaåˆ†å¸ƒ**ä¸­çš„æ··åˆå‚æ•°

<br/>

**betaåˆ†å¸ƒï¼š**

<p align="center">
    <img src="https://hhhi21g.github.io/public/img/ar02/a1.png" alt="alt text" style="zoom:50%;" />
</p>

å…¶å–å€¼èŒƒå›´ä¸º(0,1)ï¼Œæ‰€ä»¥å®ƒç»å¸¸ç”¨äºè¡¨ç¤ºæ¦‚ç‡æˆ–ç³»æ•°çš„æƒé‡ï¼Œæ¯”å¦‚åœ¨Mixupé‡Œå†³å®šä¸¤ä¸ªæ ·æœ¬çš„æ··åˆæ¯”ä¾‹ã€‚

åœ¨Mixupæ•°æ®å¢å¼ºä¸­ï¼š

- Î± = 1æ—¶ï¼ŒÎ»æœä»å‡åŒ€åˆ†å¸ƒï¼Œå³Mixupéšæœºé€‰æ‹©ä¸¤ç§æ•°æ®çš„æƒé‡ï¼›
- Î± > 1æ—¶ï¼ŒÎ»æ›´æ¥è¿‘0.5ï¼Œè¡¨ç¤ºç”Ÿæˆçš„æ•°æ®æ›´åŠ å‡åŒ€åœ°èåˆäº†ä¸¤ä¸ªæ ·æœ¬çš„ä¿¡æ¯ï¼›
- Î± < 1æ—¶ï¼ŒÎ»å¯èƒ½éå¸¸æ¥è¿‘0æˆ–1ï¼Œè¡¨ç¤ºç”Ÿæˆçš„æ•°æ®æ›´æ¥è¿‘å…¶ä¸­ä¸€ä¸ªåŸå§‹æ ·æœ¬

------

#### BASRec

ä¸‹é¢ä¸¤ä¸ªå¢å¼ºæ¨¡å—æ˜¯**ç‹¬ç«‹**çš„å¢å¼ºè·¯å¾„ï¼Œå³é€šè¿‡å•åºåˆ—å¢å¼ºç”Ÿæˆçš„åºåˆ—è¡¨ç¤ºä¸ä¼šè¢«fed intoè·¨åºåˆ—å¢å¼ºä¸­ã€‚

##### 1. Single-sequence Augmentation

**Look-upæ“ä½œ**ï¼šç»™å®šåŸå§‹çš„ç”¨æˆ·äº¤äº’åºåˆ— s<sub>u</sub>=[v<sub>1</sub>,v<sub>2</sub>,â€¦,v<sub>\|su\|</sub>], é€šè¿‡Look-upæ“ä½œä»ç‰©ä½“åµŒå…¥çŸ©é˜µä¸­è·å–è¯¥åºåˆ—å¯¹åº”çš„ç‰©å“åµŒå…¥è¡¨ç¤º:  Eu=[m<sub>v1</sub>,m<sub>v2</sub>,â€¦,m<sub>v\|su\|</sub>]ï¼›

çœç•¥å¯¹çŸ­åºåˆ—çš„å¡«å……å’Œå¯¹é•¿åºåˆ—çš„æˆªæ–­ï¼›

<p align="center">
    <img src="https://hhhi21g.github.io/public/img/ar02/a8.png" alt="alt text" style="zoom:50%;" />
</p>

**(1) M-Reorder:**

- é€‰æ‹©å­åºåˆ—(sub-sequence)é•¿åº¦: length c = rate Â· \|s<sub>u</sub>\|

â€‹	ä¸åƒä¼ ç»Ÿæ“ä½œé‚£æ ·ä½¿ç”¨ä¸€ä¸ªå›ºå®šä¸å˜çš„rate, è¿™é‡Œrateä»å‡åŒ€åˆ†å¸ƒ(Uniform distribution)ä¸­é€‰å–: 

â€‹        **rate ~ Uniform(a,b)**ã€‚a,bä¸ºè¶…å‚æ•°ï¼Œä¸”0<a<b<1

- éšæœºæ‰“ä¹±å­åºåˆ—ï¼š

  [v<sub>i</sub> , ... , v<sub>i+c-1</sub>]æ‰“ä¹±ä¸º[v<sub>i</sub><sup>'</sup> , ... v<sub>i+c-1</sub><sup>'</sup>] ï¼Œå†ä¸å­åºåˆ—å¤–çš„é¡¹æ‹¼æ¥å¾—åˆ°ï¼š

  **s<sub>u</sub><sup>'</sup>** = Record(s<sub>u</sub>) = [v<sub>1</sub> , v<sub>2</sub> , ... v<sub>i</sub><sup>'</sup> , ... v<sub>i+c-1</sub><sup>'</sup> ... ,v<sub>n</sub>]&nbsp;&nbsp;&nbsp;Â &nbsp;&nbsp;

- æ··åˆåºåˆ—ï¼š

  <p align="center">
      <img src="https://hhhi21g.github.io/public/img/ar02/a2.png" alt="alt text" style="zoom:67%;" />
  </p>

â€‹       E<sub>u</sub><sup>In</sup> is augment representation used for model training.

 **(2) M-Substitute**

- éšæœºé€‰å–c = rate Â· \|s<sub>u</sub>\| different indices {idx<sub>1</sub>, idx<sub>2</sub>, ..... ,idx<sub>c</sub>}, rateé€‰å–æ–¹å¼åŒM-Recorderï¼›

- <p align="center">
      <img src="https://hhhi21g.github.io/public/img/ar02/a3.png" alt="alt text" style="zoom:67%;" />
  </p>

- å†è¿›è¡ŒM-Recorderä¸­çš„æ··åˆåºåˆ—æ“ä½œï¼Œå¾—åˆ°E<sub>u</sub><sup>In</sup>ã€‚

**(3) è‡ªé€‚åº”æŸå¤±åŠ æƒ(Adaptive Loss Weighting)**

- è®¡ç®—åˆå§‹åŠ æƒï¼š

  <p align="center">
      <img src="https://hhhi21g.github.io/public/img/ar02/a4.png" alt="alt text" style="zoom:67%;" />
  </p>

- å¯¹w<sup>(1)</sup>è¿›è¡Œå½’ä¸€åŒ–ï¼š

  <p align="center">
      <img src="https://hhhi21g.github.io/public/img/ar02/a5.png" alt="alt text" style="zoom:67%;" />
  </p>

- è¾“å‡ºåŠ æƒw = w<sup>(2)</sup>ï¼Œå¹¶ä¸ºæ¯ä¸ªå¢å¼ºåçš„è¡¨ç¤ºE<sub>u</sub><sup>f</sup>åˆ†é…ä¸€ä¸ªç‹¬ç«‹çš„æƒé‡ï¼›

è¿™ä¸ªè¿‡ç¨‹èƒ½å¤ŸæŒ‡å¯¼æ¨¡å‹è¾¨åˆ«åŸå§‹è¡¨ç¤ºä¸­è¢«æ³¨å…¥äº†å¤šå°‘æ–°çš„è¡¨ç¤ºï¼Œæé«˜æ¨¡å‹çš„é²æ£’æ€§ã€‚

##### 2. Cross-sequence Augmentaion

è·¨åºåˆ—å¢å¼ºé€šè¿‡æ··åˆä¸åŒçš„åºåˆ—è¾“å‡ºï¼Œä»¥å‘ç°ä¸åŒç”¨æˆ·ä¹‹é—´çš„åå¥½çŸ¥è¯†ã€‚

- å°†åºåˆ—è¡¨ç¤ºE<sub>u</sub>å’ŒE<sub>u</sub><sup>In</sup>è¾“å…¥åˆ°ç¼–ç å™¨ï¼Œè·å¾—åºåˆ—çš„è¾“å‡ºè¡¨ç¤ºH<sub>u</sub>å’ŒH<sub>u</sub><sup>In</sup>;

  æ¨èç³»ç»Ÿä¸­ï¼Œç”¨æˆ·è¡¨ç¤ºé€šå¸¸æ˜¯éšå¼çš„ï¼Œå› æ­¤H<sub>u</sub>å’ŒH<sub>u</sub><sup>In</sup>ä¹Ÿå¯ä»¥çœ‹ä½œç”¨æˆ·è¡¨ç¤ºï¼›

- è¿™é‡Œæƒ³è¦åº”ç”¨ä¸åŒçš„æƒé‡ç»™H<sub>u</sub>é‡Œçš„æ¯ä¸€ä¸ªå‚æ•°ï¼Œä½†æ˜¯ï¼Œè¿™ç§æ··åˆç­–ç•¥ä¼šé€ æˆæ˜¾è‘—çš„è®¡ç®—å¼€é”€ï¼›

  å› æ­¤æå‡ºä¸€ç§åˆ†è§£è¿™ä¸ªè¿‡ç¨‹çš„æ–¹å¼ï¼Œåˆ†è§£ä¸ºï¼š**Item-wise mixup**å’Œ**Feature-wise mixup**

**å…·ä½“å®ç°ï¼š**

- ç»™å‡ºä¸€ç»„åºåˆ—**{s<sub>u</sub>}<sub>u=1</sub><sup>B</sup>,**èƒ½å¤Ÿè·å¾—ç›¸åº”çš„è¡¨ç¤º**{H<sub>u</sub>}<sub>u=1</sub><sup>B</sup> âˆˆ R<sup>BÂ * NÂ * D</sup>**, (B: æ‰¹é‡å¤§å°ï¼›Nï¼šæœ€å¤§åºåˆ—é•¿åº¦ï¼›Dï¼šåµŒå…¥ç»´åº¦)

â€‹	ä»æ‰¹å¤„ç†çš„è§†è§’æ´—ç‰ŒH<sub>u</sub>: **{H'<sub>u</sub>}<sub>u=1</sub><sup>B</sup> = Shuffle{H<sub>u</sub>}<sub>u=1</sub><sup>B</sup>**  

- For **Item-wise Nonlinear Mixup**:

  ä»Beta(*Î±, Î±*)ä¸­æŠ½å–ä¸€ä¸ªæ··åˆçš„**æƒé‡çŸ©é˜µ Î›<sub>*I*</sub>âˆˆR<sup>B*N</sup>** ï¼Œæ··åˆæ“ä½œå¦‚ä¸‹ï¼ˆHadamard product)ï¼š

  <p align="center">
      <img src="https://hhhi21g.github.io/public/img/ar02/a6.png" alt="alt text" style="zoom:67%;" />
  </p>

- For **Feature-wise Nonlinear Mixup**:

  ä»Beta(*Î±, Î±*)ä¸­æŠ½å–ä¸€ä¸ªæ··åˆçš„**æƒé‡çŸ©é˜µ Î›<sub>*F*</sub>âˆˆR<sup>B*N</sup>**,ä½œç›¸ä¼¼æ“ä½œï¼š

  <p align="center">
      <img src="https://hhhi21g.github.io/public/img/ar02/a7.png" alt="alt text" style="zoom:67%;" />
  </p>

------

#### æ¨¡å‹è®­ç»ƒ

**BCEï¼ˆbinary cross-entropy)**

<p align="center">
    <img src="https://hhhi21g.github.io/public/img/ar02/a9.png" alt="alt text" style="zoom:67%;" />
</p>

*H<sub>u</sub>, E<sub>u</sub><sup>+</sup>, E<sub>u</sub><sup>-</sup>*: the user, the positive and negative items. &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;*Ïƒ*(): the sigmoid function

*L*<sub>main</sub>ä¸­çš„è¡¨ç¤ºä¸ä¼šè¢«å¢å¼ºï¼›

**å¯¹äºæ¯ä¸ªåºåˆ—ï¼Œæˆ‘ä»¬åº”ç”¨ä¸¤ä¸ªç®—å­ä»¥å¢å¼ºï¼š**

**å•åºåˆ—å¢å¼º(ssa)**:

<p align="center">
    <img src="https://hhhi21g.github.io/public/img/ar02/a10.png" alt="alt text" style="zoom:67%;" />
</p>
*Ï‰* : the pre-computed weights to reweight the objective function

**è·¨åºåˆ—å¢å¼º(csa):**

<p align="center">
    <img src="https://hhhi21g.github.io/public/img/ar02/a11.png" alt="alt text" style="zoom:67%;" />
</p>

**ä¸¤é˜¶æ®µè®­ç»ƒç­–ç•¥ï¼š**

- ç¬¬ä¸€é˜¶æ®µï¼š

  ä½¿ç”¨æ ‡å‡†çš„åºåˆ—æ¨èæ¨¡å‹ï¼Œé¦–è¦ç›®æ ‡æ˜¯å­¦ä¹ é¡¹çš„é«˜è´¨é‡è¡¨è¾¾ï¼Œä»…ä½¿ç”¨(13)å¼ï¼›

- ç¬¬äºŒé˜¶æ®µï¼š

  åº”ç”¨ä¸¤ä¸ªå¢å¼ºæ¨¡å—ï¼Œæœ€ç»ˆçš„ç›®æ ‡æŸå¤±ä¸ºï¼š

  <p align="center">
      <img src="https://hhhi21g.github.io/public/img/ar02/a12.png" alt="alt text" style="zoom:67%;" />
  </p>

<u>è¿™é‡Œä¸ä¸ºL<sub>ssa</sub>å’ŒL<sub>csa</sub>è®¾ç½®é¢å¤–æƒé‡ï¼š</u>

(1)L<sub>ssa</sub>åœ¨å‰é¢å·²ç»è¿›è¡Œè¿‡åŠ æƒï¼›

(2)åœ¨ä¸¤ä¸ªå¢å¼ºæ¨¡å—ä¸­ï¼Œæ•°æ®å¢å¼ºçš„æ ·æœ¬ä¸åŸå§‹æ ·æœ¬åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­è¢«å¹³ç­‰å¯¹å¾…ï¼Œæ¯ä¸ªå¢å¼ºçš„æ ·æœ¬å¯ä»¥è¢«è§†ä¸ºåœ¨è¡¨ç¤ºç©ºé—´ä¸­ç”Ÿæˆçš„ä¸€ä¸ªæ–°çš„ç”¨æˆ·å’Œäº¤äº’ã€‚

**åœ¨æ¨ç†é˜¶æ®µï¼Œæ‰€æœ‰å¢å¼ºæ¨¡å‹éƒ½ä¼šè¢«åœç”¨**

> During the inference phase, all augmentation modules are deactivated.

------

